<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Control Room</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Configurazione Esperimento</h1>
    <div class="card">
        <label>Codice Utente:</label>
        <input type="text" id="userId" placeholder="Es. USER_01">
        
        <label style="display:block; margin-top:15px">Tipo di esperimento erogato:</label>
        <select id="ExperimentOrder">
            <option value="e1_e2">1° Esperimento1 &rarr; 2° Esperimento2</option>
            <option value="e2_e1">1° Esperimento2 &rarr; 2° Esperimento1</option>
        </select>

        <label style="display:block; margin-top:15px">Sequenza Luci:</label>
        <select id="lightOrder">
            <option value="Welt_Vitasolis">1° Welt &rarr; 2° Vitasolis</option>
            <option value="Vitasolis_Welt">1° Vitasolis &rarr; 2° Welt</option>
        </select>

        <button onclick="startExperiment()">SALVA E PREPARA</button>
    </div>

    <script>
        function startExperiment() {
            try {
                const uid = document.getElementById('userId').value;
                const Lightorder = document.getElementById('lightOrder').value;
                const ExperimentOrder = document.getElementById('ExperimentOrder').value;
                
                if(!uid) return alert("Inserisci ID Utente prima di procedere!");

                const [l1, l2] = Lightorder.split('_');
                const [e1, e2] = ExperimentOrder.split('_');
                
                localStorage.clear();
         
                localStorage.setItem('userId', uid);
                localStorage.setItem('light1_name', l1);
                localStorage.setItem('light2_name', l2);
                localStorage.setItem('phase1_name', e1);
                localStorage.setItem('phase2_name', e2);
                localStorage.setItem('stepIndex', -1); 

                alert("Configurazione Salvata per utente: " + uid + "\nPremi OK per iniziare.");

                window.location.href = "intro.html";
            } catch (err) {
                alert("ERRORE NEL CODICE: " + err.message);
            }
        }
    </script>
</body>
</html>